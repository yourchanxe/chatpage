<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>터치 지원 드로잉 앱</title>
<style>
  body {
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    background-color: #f7f7f7;
  }
  #header {
    width: 100%;
    background-color: #333;
    color: white;
    text-align: center;
    padding: 10px 0;
    margin-bottom: 20px; /* 헤더와 툴바 사이의 공간 추가 */
  }
  #drawingCanvas {
    border: 1px solid #000;
    margin-top: 10px;
  }
  .toolbar {
    display: flex;
    justify-content: center;
    margin-bottom: 5px;
  }
  button {
    margin: 0 5px;
  }
  .footer {
    width: 100%;
    background-color: #333;
    color: white;
    text-align: center;
    padding: 10px 0;
    position: absolute;
    bottom: 0;
  }
  .footer button {
    background-color: #555;
    color: white;
    border: none;
    padding: 10px 15px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="header">thisground.com</div>
<div class="toolbar">
  <label for="brushSize">브러시 크기:</label>
  <input type="range" id="brushSize" min="1" max="10" value="5">
  <label for="colors">색상 선택:</label>
  <input type="color" id="colors">
  <button id="clearCanvas">지우기</button>
  <button id="download">다운로드</button>
</div>
<canvas id="drawingCanvas" width="1000" height="800"></canvas>
<div class="footer">
  <button onclick="location.href='temp1.html'">추가예정1</button>
  <button onclick="location.href='temp2.html'">추가예정2</button>
  <button onclick="location.href='temp3.html'">추가예정3</button>
</div>
<script>
  const canvas = document.getElementById('drawingCanvas');
  const ctx = canvas.getContext('2d');
  const brushSize = document.getElementById('brushSize');
  const colors = document.getElementById('colors');
  const clearCanvas = document.getElementById('clearCanvas');
  const downloadBtn = document.getElementById('download');
  
  let drawing = false;
  
  function startDrawing(e) {
    e.preventDefault(); // 스크롤 방지
    drawing = true;
    draw(e);
  }
  
  function endDrawing(e) {
    e.preventDefault(); // 스크롤 방지
    drawing = false;
    ctx.beginPath();
  }
  
  function draw(e) {
    e.preventDefault(); // 스크롤 방지
    if (!drawing) return;
    
    let x = e.clientX - canvas.offsetLeft;
    let y = e.clientY - canvas.offsetTop;
    
    // 터치 이벤트를 위한 조건문
    if (e.touches) {
      x = e.touches[0].clientX - canvas.offsetLeft;
      y = e.touches[0].clientY - canvas.offsetTop;
    }
    
    ctx.lineWidth = brushSize.value;
    ctx.lineCap = 'round';
    ctx.strokeStyle = colors.value;
    
    ctx.lineTo(x, y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x, y);
  }
  
  function clearTheCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  
  // 그림을 이미지 파일로 다운로드하는 함수
  function downloadImage() {
    const image = canvas.toDataURL('image/png').replace('image/png', 'image/octet-stream');
    const link = document.createElement('a');
    link.download = 'my-drawing.png';
    link.href = image;
    link.click();
  }
  
  // 캔버스 상태를 저장하는 함수
  function saveCanvas() {
    localStorage.setItem('savedCanvas', canvas.toDataURL());
  }
  
  // 캔버스 상태를 불러오는 함수
  function loadCanvas() {
    const savedCanvas = localStorage.getItem('savedCanvas');
    if (savedCanvas) {
      const img = new Image();
      img.onload = function() {
        ctx.drawImage(img, 0, 0);
      };
      img.src = savedCanvas;
    }
  }
  
  // 마우스 이벤트 리스너
  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('mouseup', endDrawing);
  canvas.addEventListener('mousemove', draw);
  
  // 터치 이벤트 리스너
  canvas.addEventListener('touchstart', startDrawing);
  canvas.addEventListener('touchend', endDrawing);
  canvas.addEventListener('touchmove', draw);
  
  clearCanvas.addEventListener('click', clearTheCanvas);
  downloadBtn.addEventListener('click', downloadImage);
  
  // 페이지 로드 시 캔버스 불러오기
  window.onload = loadCanvas;
  // 캔버스 상태 저장
  window.onbeforeunload = saveCanvas;
  
</script>
</body>
</html>
